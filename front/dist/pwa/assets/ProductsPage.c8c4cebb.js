import{c as J,ba as H,d as K,r as F,bb as Y,f as V,bc as Z,w as T,X as $,p,aF as v,t as ee,I as m,q as te,aH as le,B as x,C as w,E as s,H as i,S,U as C,J as f,G as n,K as B,bd as R,aM as b,R as M,Q as y,V as oe,a$ as I}from"./index.9edba5f1.js";import{Q as q,e as h}from"./QItem.eff87168.js";import{Q as ie}from"./QBtnGroup.6b583132.js";import{a as ne}from"./QMenu.037e31f1.js";import{Q as ae,a as U}from"./QTable.11f5663d.js";import{Q as _}from"./QImg.222921e7.js";import{Q as se}from"./QSpace.4e595e69.js";import{Q as k}from"./QBadge.ea022153.js";import{Q as g}from"./QSelect.c18c5acd.js";import{Q as de}from"./QForm.6c489b8e.js";import{Q as re}from"./QPage.8e64ec2d.js";import{C as P}from"./ClosePopup.f357f1c9.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./selection.83a0f183.js";import"./QList.7302da53.js";import"./use-fullscreen.f8a2fd6b.js";import"./format.2cae61da.js";const ce=Object.keys(H);function me(e){return ce.reduce((t,r)=>{const c=e[r];return c!==void 0&&(t[r]=c),t},{})}var ge=J({name:"QBtnDropdown",props:{...H,...K,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:r}){const{proxy:c}=te(),o=F(e.modelValue),a=F(null),l=Y(),u=V(()=>{const d={"aria-expanded":o.value===!0?"true":"false","aria-haspopup":"true","aria-controls":l.value,"aria-label":e.toggleAriaLabel||c.$q.lang.label[o.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(d["aria-disabled"]="true"),d}),N=V(()=>"q-btn-dropdown__arrow"+(o.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),A=V(()=>Z(e)),D=V(()=>me(e));T(()=>e.modelValue,d=>{a.value!==null&&a.value[d?"show":"hide"]()}),T(()=>e.split,Q);function L(d){o.value=!0,r("beforeShow",d)}function E(d){r("show",d),r("update:modelValue",!0)}function G(d){o.value=!1,r("beforeHide",d)}function O(d){r("hide",d),r("update:modelValue",!1)}function X(d){r("click",d)}function j(d){le(d),Q(),r("click",d)}function W(d){a.value!==null&&a.value.toggle(d)}function z(d){a.value!==null&&a.value.show(d)}function Q(d){a.value!==null&&a.value.hide(d)}return Object.assign(c,{show:z,hide:Q,toggle:W}),$(()=>{e.modelValue===!0&&z()}),()=>{const d=[p(v,{class:N.value,name:e.dropdownIcon||c.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&d.push(p(ne,{ref:a,id:l.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:L,onShow:E,onBeforeHide:G,onHide:O},t.default)),e.split===!1?p(m,{class:"q-btn-dropdown q-btn-dropdown--simple",...D.value,...u.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:X},{default:()=>ee(t.label,[]).concat(d),loading:t.loading}):p(ie,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...A.value,glossy:e.glossy,stretch:e.stretch},()=>[p(m,{class:"q-btn-dropdown--current",...D.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:j},{default:t.label,loading:t.loading}),p(m,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...u.value,...A.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>d)])}}});const pe={name:"ProductsPage",data(){return{filter:"",products:[],product:{},categories:[],subcategories:[],items:["S","M","L","XL","XXL","XXXL"],loading:!1,dialog:!1,imgChange:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"titulo",label:"Titulo",align:"left",field:e=>e.titulo},{name:"precio",label:"Precio",align:"right",field:e=>e.precio},{name:"precioAnterior",label:"Precio Anterior",align:"right",field:e=>e.precioAnterior},{name:"stock",label:"Stock",align:"right",field:e=>e.stock},{name:"masVendido",label:"Mas Vendido",align:"left",field:e=>e.masVendido},{name:"category",label:"Categoria",align:"left",field:e=>e.category.name},{name:"items",label:"Items",align:"left",field:e=>`${e.item1===null?"":e.item1} ${e.item2===null?"":e.item2} ${e.item3===null?"":e.item3} ${e.item4===null?"":e.item4} ${e.item5===null?"":e.item5} ${e.item6===null?"":e.item6}`},{name:"sub_category",label:"Sub Categoria",align:"left",field:e=>e.sub_category.name}]}},mounted(){this.getProducts(),this.categorieGet(),this.subcategorieGet()},methods:{formProduct(e){if(!e.imagen1&&!e.imagen2&&!e.imagen3&&!e.imagen4){this.$alert.error("Debe seleccionar al menos una imagen");return}e.id?this.updateProduct(e):this.createProduct(e)},createProduct(e){this.loading=!0,this.$axios.post("products",e).then(t=>{this.$alert.success("Producto creado"),this.dialog=!1,this.products.push(t.data)}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},updateProduct(e){this.loading=!0,this.$axios.put(`products/${e.id}`,e).then(t=>{this.$alert.success("Producto actualizado"),this.dialog=!1;const r=this.products.findIndex(c=>c.id===e.id);this.products[r]={...e}}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},categorieGet(){this.$axios.get("categories").then(e=>{this.categories=e.data})},subcategorieGet(){this.$axios.get("subCategories").then(e=>{this.subcategories=e.data})},imgUrl(e){return e?e.includes("base64")?e:`${this.$url}../images/${e}`:null},clickImagen(e){this.imgChange=e,document.getElementById("file").click()},onFileChange(e){const t=e.target.files[0],r=new FileReader;r.readAsDataURL(t),r.onload=c=>{this.product[this.imgChange]=c.target.result;const o=new FormData;o.append("file",t),o.append("field",this.imgChange),this.$axios.post("uploadProduct/"+this.product.id,o,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{if(this.$alert.success("Imagen subida"),console.log(a),a.data.esImagen)this.product[a.data.field]=a.data.name;else{this.product={...a.data};const l=this.products.findIndex(u=>u.id===this.product.id);this.products[l]={...this.product}}}).catch(a=>{this.$alert.error(a.response.data.message)})}},deleteProduct(e){this.$q.dialog({title:"Eliminar",message:"\xBFEst\xE1 seguro de eliminar este producto?",ok:"Si",cancel:"No"}).onOk(()=>{this.loading=!0,this.$axios.delete(`products/${e.id}`).then(t=>{this.$alert.success("Producto eliminado"),this.products=this.products.filter(r=>r.id!==e.id)}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})})},editProductTable(e,t){this.dialog=!0,this.product={...t}},updateProductoVendido(e){this.$axios.put(`products/${e.id}`,{masVendido:e.masVendido}).then(t=>{this.$alert.success("Producto actualizado")}).catch(t=>{this.$alert.error(t.response.data.message)})},showNewProduct(){this.dialog=!0,this.product={id:null,descripcion:"",titulo:"",precio:0,masVendido:"no",imagen1:"",imagen2:"",imagen3:"",imagen4:"",item1:"",item2:"",item3:"",item4:"",item5:"",item6:"",item7:"",item8:"",item9:"",item10:"",precioAnterior:0,stock:0,category_id:1,sub_category_id:1}},getProducts(){this.loading=!0,this.$axios.get("products").then(e=>{this.products=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},fe={class:"text-subtitle1 text-bold"},be={class:"row"},he={class:"col-6 col-md-3 text-center"},_e={class:"col-6 col-md-3 text-center"},ve={class:"col-6 col-md-3 text-center"},Ve={class:"col-6 col-md-3 text-center"},xe={class:"col-12 col-md-12"},we=n("label",{class:"text-bold"},"Descripcion",-1),Ce={class:"col-12 col-md-6"},ye=n("label",{class:"text-bold"},"Titulo",-1),ke={class:"col-6 col-md-2"},Pe=n("label",{class:"text-bold"},"Precio",-1),Qe={class:"col-6 col-md-2"},Se=n("label",{class:"text-bold"},"Precio Anterior",-1),Be={class:"col-12 col-md-2 text-center"},Ie=n("label",{class:"text-bold"},"Mas vendido",-1),qe=n("br",null,null,-1),Ue={class:"col-4 col-md-2"},Ae=n("label",{class:"text-bold"},"Item 1",-1),De={class:"col-4 col-md-2"},ze=n("label",{class:"text-bold"},"Item 2",-1),Fe={class:"col-4 col-md-2"},Te=n("label",{class:"text-bold"},"Item 3",-1),Re={class:"col-4 col-md-2"},Me=n("label",{class:"text-bold"},"Item 4",-1),He={class:"col-4 col-md-2"},Ne=n("label",{class:"text-bold"},"Item 5",-1),Le={class:"col-4 col-md-2"},Ee=n("label",{class:"text-bold"},"Item 6",-1),Ge={class:"col-6 col-md-4"},Oe=n("label",{class:"text-bold"},"Stock",-1),Xe={class:"col-6 col-md-4"},je=n("label",{class:"text-bold"},"Categoria",-1),We={class:"col-6 col-md-4"},Je=n("label",{class:"text-bold"},"Sub Categoria",-1),Ke={class:"col-12 text-right q-mt-xs"},Ye=n("div",null,null,-1);function Ze(e,t,r,c,o,a){return x(),w(re,{class:"q-pa-xs bg-grey-3"},{default:s(()=>[i(M,null,{default:s(()=>[i(S,{class:"q-pa"},{default:s(()=>[i(ae,{rows:o.products,dense:"","wrap-cells":"",columns:o.columns,loading:o.loading,"rows-per-page-options":[0],onRowClick:a.editProductTable,filter:o.filter,"no-data-label":"No hay productos"},{"body-cell-actions":s(l=>[i(U,{props:l,"auto-width":"",style:{margin:"0px",padding:"0px"}},{default:s(()=>[i(ge,{"dropdown-icon":"more_vert",flat:"",dense:"",style:{border:"0px",margin:"0px",padding:"0px"},size:"13px",onClick:t[0]||(t[0]=u=>{u.stopPropagation()})},{default:s(()=>[C((x(),w(q,{clickable:"",onClick:u=>a.editProductTable(u,l.row)},{default:s(()=>[i(h,{avatar:""},{default:s(()=>[i(v,{name:"visibility"})]),_:1}),i(h,null,{default:s(()=>[f(" Ver "),n("pre",null,B(l.row),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[I],[P]]),C((x(),w(q,{clickable:"",onClick:u=>a.editProductTable(u,l.row)},{default:s(()=>[i(h,{avatar:""},{default:s(()=>[i(v,{name:"edit"})]),_:1}),i(h,null,{default:s(()=>[f("Editar")]),_:1})]),_:2},1032,["onClick"])),[[I],[P]]),C((x(),w(q,{clickable:"",onClick:u=>a.deleteProduct(l.row)},{default:s(()=>[i(h,{avatar:""},{default:s(()=>[i(v,{name:"delete"})]),_:1}),i(h,null,{default:s(()=>[f("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[I],[P]])]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-titulo":s(l=>[i(U,{props:l,style:{margin:"0px",padding:"0px"}},{default:s(()=>[i(_,{src:`${e.$url}../images/${l.row.imagen1}`,style:{width:"25px",height:"25px"}},null,8,["src"]),f(" "+B(l.row.titulo),1)]),_:2},1032,["props"])]),"body-cell-masVendido":s(l=>[i(U,{props:l,"auto-width":"",style:{margin:"0px",padding:"0px"}},{default:s(()=>[i(R,{modelValue:l.row.masVendido,"onUpdate:modelValue":[u=>l.row.masVendido=u,u=>a.updateProductoVendido(l.row)],dense:"","false-value":"no","true-value":"si",label:l.row.masVendido,color:l.row.masVendido==="si"?"green":"grey"},null,8,["modelValue","onUpdate:modelValue","label","color"])]),_:2},1032,["props"])]),"top-right":s(()=>[i(m,{color:"primary",label:"Nuevo Producto","no-caps":"",dense:"",icon:"add_circle_outline",onClick:a.showNewProduct,loading:o.loading},null,8,["onClick","loading"]),i(b,{modelValue:o.filter,"onUpdate:modelValue":t[1]||(t[1]=l=>o.filter=l),debounce:"300",dense:"",outlined:"",placeholder:"Buscar..."},{prepend:s(()=>[i(v,{name:"search"})]),_:1},8,["modelValue"])]),default:s(()=>[f(" > ")]),_:1},8,["rows","columns","loading","onRowClick","filter"])]),_:1})]),_:1}),i(oe,{modelValue:o.dialog,"onUpdate:modelValue":t[26]||(t[26]=l=>o.dialog=l),persistent:""},{default:s(()=>[i(M,{style:{width:"750px","max-width":"90vw"}},{default:s(()=>[i(S,{class:"row items-center q-pb-none"},{default:s(()=>[n("div",fe,B(o.product.id?"Editar":"Nuevo")+" Producto ",1),i(se),i(m,{flat:"",dense:"",icon:"close",onClick:t[2]||(t[2]=l=>o.dialog=!1)})]),_:1}),i(S,{class:"q-pt-none"},{default:s(()=>[i(de,{onSubmit:t[25]||(t[25]=l=>a.formProduct(o.product))},{default:s(()=>[n("div",be,[n("div",he,[i(y,{bordered:"",size:"100px",square:""},{default:s(()=>[i(_,{src:a.imgUrl(o.product.imagen1)},null,8,["src"]),i(k,{color:"white",floating:""},{default:s(()=>[i(m,{flat:"",dense:"",icon:"camera_alt",color:"grey",size:"9px",onClick:t[3]||(t[3]=l=>a.clickImagen("imagen1"))}),n("input",{type:"file",class:"hidden",id:"file",onChange:t[4]||(t[4]=(...l)=>a.onFileChange&&a.onFileChange(...l)),accept:"image/*"},null,32)]),_:1})]),_:1})]),n("div",_e,[i(y,{bordered:"",size:"100px",square:""},{default:s(()=>[i(_,{src:a.imgUrl(o.product.imagen2)},null,8,["src"]),i(k,{color:"white",floating:""},{default:s(()=>[i(m,{flat:"",dense:"",icon:"camera_alt",color:"grey",size:"9px",onClick:t[5]||(t[5]=l=>a.clickImagen("imagen2"))}),n("input",{type:"file",class:"hidden",id:"file",onChange:t[6]||(t[6]=(...l)=>a.onFileChange&&a.onFileChange(...l)),accept:"image/*"},null,32)]),_:1})]),_:1})]),n("div",ve,[i(y,{bordered:"",size:"100px",square:""},{default:s(()=>[i(_,{src:a.imgUrl(o.product.imagen3)},null,8,["src"]),i(k,{color:"white",floating:""},{default:s(()=>[i(m,{flat:"",dense:"",icon:"camera_alt",color:"grey",size:"9px",onClick:t[7]||(t[7]=l=>a.clickImagen("imagen3"))}),n("input",{type:"file",class:"hidden",id:"file",onChange:t[8]||(t[8]=(...l)=>a.onFileChange&&a.onFileChange(...l)),accept:"image/*"},null,32)]),_:1})]),_:1})]),n("div",Ve,[i(y,{bordered:"",size:"100px",square:""},{default:s(()=>[i(_,{src:a.imgUrl(o.product.imagen4)},null,8,["src"]),i(k,{color:"white",floating:""},{default:s(()=>[i(m,{flat:"",dense:"",icon:"camera_alt",color:"grey",size:"9px",onClick:t[9]||(t[9]=l=>a.clickImagen("imagen4"))}),n("input",{type:"file",class:"hidden",id:"file",onChange:t[10]||(t[10]=(...l)=>a.onFileChange&&a.onFileChange(...l)),accept:"image/*"},null,32)]),_:1})]),_:1})]),n("div",xe,[we,i(b,{modelValue:o.product.descripcion,"onUpdate:modelValue":t[11]||(t[11]=l=>o.product.descripcion=l),dense:"",outlined:"",type:"textarea",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",Ce,[ye,i(b,{modelValue:o.product.titulo,"onUpdate:modelValue":t[12]||(t[12]=l=>o.product.titulo=l),dense:"",outlined:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",ke,[Pe,i(b,{modelValue:o.product.precio,"onUpdate:modelValue":t[13]||(t[13]=l=>o.product.precio=l),dense:"",outlined:"",type:"number"},null,8,["modelValue"])]),n("div",Qe,[Se,i(b,{modelValue:o.product.precioAnterior,"onUpdate:modelValue":t[14]||(t[14]=l=>o.product.precioAnterior=l),dense:"",outlined:"",type:"number"},null,8,["modelValue"])]),n("div",Be,[Ie,f(),qe,i(R,{modelValue:o.product.masVendido,"onUpdate:modelValue":t[15]||(t[15]=l=>o.product.masVendido=l),dense:"","false-value":"no","true-value":"si",label:`${o.product.masVendido}`,color:o.product.masVendido==="si"?"green":"grey"},null,8,["modelValue","label","color"])]),n("div",Ue,[Ae,i(g,{modelValue:o.product.item1,"onUpdate:modelValue":t[16]||(t[16]=l=>o.product.item1=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",De,[ze,i(g,{modelValue:o.product.item2,"onUpdate:modelValue":t[17]||(t[17]=l=>o.product.item2=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",Fe,[Te,i(g,{modelValue:o.product.item3,"onUpdate:modelValue":t[18]||(t[18]=l=>o.product.item3=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",Re,[Me,i(g,{modelValue:o.product.item4,"onUpdate:modelValue":t[19]||(t[19]=l=>o.product.item4=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",He,[Ne,i(g,{modelValue:o.product.item5,"onUpdate:modelValue":t[20]||(t[20]=l=>o.product.item5=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",Le,[Ee,i(g,{modelValue:o.product.item6,"onUpdate:modelValue":t[21]||(t[21]=l=>o.product.item6=l),dense:"",outlined:"",options:o.items},null,8,["modelValue","options"])]),n("div",Ge,[Oe,i(b,{modelValue:o.product.stock,"onUpdate:modelValue":t[22]||(t[22]=l=>o.product.stock=l),dense:"",outlined:"",type:"number"},null,8,["modelValue"])]),n("div",Xe,[je,i(g,{modelValue:o.product.category_id,"onUpdate:modelValue":t[23]||(t[23]=l=>o.product.category_id=l),dense:"",outlined:"",options:o.categories,"emit-value":"","map-options":"","option-value":"id","option-label":"name"},null,8,["modelValue","options"])]),n("div",We,[Je,i(g,{modelValue:o.product.sub_category_id,"onUpdate:modelValue":t[24]||(t[24]=l=>o.product.sub_category_id=l),dense:"",outlined:"",options:o.subcategories,"emit-value":"","map-options":"","option-value":"id","option-label":"name"},null,8,["modelValue","options"])]),n("div",Ke,[C(i(m,{label:"Cancelar",color:"grey-3",unelevated:"","text-color":"black","no-caps":"",loading:o.loading},null,8,["loading"]),[[P]]),i(m,{label:"Guardar",color:"positive",unelevated:"",class:"q-ml-xs","no-caps":"",type:"submit",loading:o.loading},null,8,["loading"])])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),Ye]),_:1})}var bt=ue(pe,[["render",Ze]]);export{bt as default};
